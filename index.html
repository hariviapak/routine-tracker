<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Routine Tracker</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="styles.css?v=2.0">
    <script src="app.js?v=2.0" defer></script>
    <meta name="theme-color" content="#4CAF50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Routine Tracker">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <h1>Daily Routine Tracker</h1>
            <div class="date-display" id="currentDate"></div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="nav-tabs">
            <button class="nav-tab active" id="todayTab" onclick="app.showTab('today')">Today</button>
            <button class="nav-tab" id="tableTab" onclick="app.showTab('table')">Table View</button>
            <button class="nav-tab" id="routinesTab" onclick="app.showTab('routines')">Manage Routines</button>
        </nav>

        <!-- Today View (Default) -->
        <div id="todayView" class="tab-content active">
            <section class="today-section">
                <div class="today-header">
                    <h2>Today's Routines</h2>
                    <div class="today-date-display" id="todayDateDisplay"></div>
                    <div class="view-toggle">
                        <button class="view-btn active" id="gridViewBtn" onclick="app.toggleView('grid')">
                            <span class="view-icon">‚äû</span> Grid
                        </button>
                        <button class="view-btn" id="listViewBtn" onclick="app.toggleView('list')">
                            <span class="view-icon">‚ò∞</span> List
                        </button>
                    </div>
                </div>
                
                <!-- Today's Routines -->
                <div class="today-routines" id="todayRoutines">
                    <!-- Routine cards will be generated here -->
                </div>
            </section>
        </div>

        <!-- Table View -->
        <div id="tableView" class="tab-content">
            <section class="table-section">
                <div class="table-header">
                    <h2>Daily Routine Table</h2>
                    <div class="table-controls">
                        <div class="date-navigation">
                            <button class="btn btn-secondary" id="prevDateBtn">‚Üê Previous</button>
                            <div class="current-date-display" id="selectedDateDisplay"></div>
                            <button class="btn btn-secondary" id="nextDateBtn">Next ‚Üí</button>
                        </div>
                        <div class="date-picker">
                            <input type="date" id="datePicker" max="">
                            <button class="btn btn-primary" id="goToDateBtn">Go to Date</button>
                        </div>
                    </div>
                </div>
                
                <div class="table-container">
                    <table class="routine-table" id="routineTable">
                        <thead>
                            <tr>
                                <th class="date-header">Date</th>
                                <!-- Routine headers will be generated here -->
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            <!-- Table rows will be generated here -->
                        </tbody>
                    </table>
                </div>
            </section>
        </div>

        <!-- Routines Management View -->
        <div id="routinesView" class="tab-content">
            <section class="routines-section">
                <!-- Add New Routine Section -->
                <div class="add-routine-section">
                    <h3>Add New Routine</h3>
                    <div class="add-routine-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="newRoutineName">Routine Name:</label>
                                <input type="text" id="newRoutineName" placeholder="e.g., Water, Medicine, Exercise">
                            </div>
                            <div class="form-group">
                                <label for="newRoutineType">Type:</label>
                                <select id="newRoutineType">
                                    <option value="counter">Counter (1, 2, 3...)</option>
                                    <option value="done">Done (‚úì)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="newRoutineTarget">Target:</label>
                                <input type="number" id="newRoutineTarget" value="1" min="1">
                            </div>
                            <div class="form-group">
                                <label for="newRoutineIcon">Icon:</label>
                                <input type="text" id="newRoutineIcon" placeholder="üíß" value="">
                            </div>
                        </div>
                        <button type="button" id="addRoutineBtn" class="btn btn-primary">Add Routine</button>
                    </div>
                </div>
                
                <!-- Data Management Section -->
                <div class="data-management-section">
                    <h3>Data Management</h3>
                    <div class="data-buttons">
                        <button type="button" id="exportDataBtn" class="btn btn-secondary">
                            üì§ Export Data
                        </button>
                        <button type="button" id="importDataBtn" class="btn btn-secondary">
                            üì• Import Data
                        </button>
                        <button type="button" id="deleteAllRoutinesBtn" class="btn btn-danger">
                            üóëÔ∏è Delete All Routines
                        </button>
                        <button type="button" id="restoreDefaultsBtn" class="btn btn-info">
                            üìã Restore Defaults
                        </button>
                    </div>
                    <p class="data-info">Export your routines and progress data for backup, or import from a previous backup file. Delete All Routines will remove all routines but keep your progress data.</p>
                </div>
                
                <!-- Current Routines -->
                <div class="current-routines">
                    <h3>Current Routines</h3>
                    <div class="routines-grid" id="routinesGrid">
                        <!-- Current routines will be displayed here -->
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Notification Toast -->
    <div class="toast" id="toast"></div>

    <!-- Service Worker Registration -->
    <script src="app.js?v=2.0" defer></script>
    <script>
        // Register service worker for PWA
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(registration => console.log('SW registered'))
                .catch(error => console.log('SW registration failed'));
        }
    </script>
</body>
</html>
